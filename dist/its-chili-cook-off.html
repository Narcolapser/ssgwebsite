<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>ITS Chili Cook Off</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="At the beginning of this month, USD ITS had its 5th annual chili cook-off. Last year I was recruited in to help with notifying everyone and..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Studio Sleepy Giraffe</a></h1>
                <nav><ul>
                    <li><a href="/pages/Home.html">Home</a></li>
                    <li class="active"><a href="/category/blog.html">Blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/its-chili-cook-off.html" rel="bookmark"
           title="Permalink to ITS Chili Cook Off">ITS Chili Cook Off</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-01-30T00:00:00-06:00">
                Published: Tue 30 January 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/toben-archer.html">Toben Archer</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>
<p>tags: <a href="/tag/website.html">Website</a> </p>
</footer><!-- /.post-info -->      <p>At the beginning of this month, USD ITS had its 5th annual chili cook-off. Last year I was recruited in to help with notifying everyone and coordinating who was bringing what. To achieve this, I made a google form/spreadsheet and google site and wrote all sorts of clever spreadsheet functions to get the information and display it as desired. It also made me a list of people who hadn't responded yet so I could remind them. It worked really well but was not quite the amazing-ness I wanted. While a lot of it was streamlined, there were parts of it that still needed to be managed by hand. So this year I wanted to improve on that. So here are the things I tried and the lessons I learned.</p>
<h1>Flask-CAS</h1>
<p>While I didn't end up using it, the first thing I tried to do was integrate Flask with our CAS (Central Authentication Service) servers. This would populate user name and email so you would just have to choose what you were bringing and hit submit. I got it to work, and it worked fine as long as you were inside the USD network. It wasn't going to work outside, and there was nowhere I could host my Flask server, so I had to forgo using this utility, but it was a good exercise in Flask and CAS. Time not wasted, in my opinion. The biggest lesson I learned from this escapade, though is that certs are annoying. </p>
<h1>Cookies</h1>
<p>Without the features that being CAS-ified allowed, I needed to find another way around that. So I turned to cookies. There isn't much to say on this front honestly. Cookies in Flask are soo incredibly easy that it's hardly worth mentioning. It looked something like this:</p>
<p>To set the cookie:</p>
<div class="highlight"><pre><span></span><code>    resp = make_response(redirect(&#39;/chili&#39;))
    resp.set_cookie(&#39;email&#39;,form.email.data)
</code></pre></div>

<p>To get the cookie:</p>
<div class="highlight"><pre><span></span><code>    email = request.cookies.get(&#39;email&#39;)
</code></pre></div>

<p>~Tada! Like magic, I'm storing info in the user's browser. Amazing how simple this is.</p>
<h1>Flask Forms</h1>
<p>This was also my first hurrah with Forms in Flask. It wasn't very hard, which is certainly something I appreciate about Flask specifically and python in general. Kind of the theme of this post "wasn't so hard since I was using python!" The thing I learned about though is mostly the declaring different types of methods in Flask and about the "make_response" method, which I used to redirect the user after they submitted their form:</p>
<div class="highlight"><pre><span></span><code>    <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">make_response</span>


    <span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/register&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
            <span class="n">form</span> <span class="o">=</span> <span class="n">RegistrationForm</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span> <span class="ow">and</span> <span class="n">form</span><span class="o">.</span><span class="n">validate</span><span class="p">():</span>
                    <span class="n">insert_resp</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">form</span><span class="o">.</span><span class="n">dish</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">form</span><span class="o">.</span><span class="n">nation</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/chili&#39;</span><span class="p">))</span>
                    <span class="n">resp</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span><span class="n">form</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">resp</span>
            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">nations</span><span class="o">=</span><span class="n">nations</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">flags</span><span class="p">)</span>
</code></pre></div>

<h1>O365 Integration</h1>
<p>This one was almost cheating. Not exactly something I learned since I wrote the O365 library. But it did serve a fantastic roll! This year the whole process was automated. As soon as I had the system up and running, it ran on its own, all the way through the holidays. I assembled it with a pair of files, all people, and have already responded. It would compare the two lists and then send a message to those yet to respond (and myself just so I could see that it was running.) It worked like a dream. Next year I will probably do something similar again. And now that I've got a lot of the coding managed already, it shouldn't take much effort. Though I'll probably put in a fair bit of energy so I can add cool new features!</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>